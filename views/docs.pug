extends layout

block content
    table.striped
        tbody
            th(width='25%') Dokument
            th(width='7%') Seiten
            th(width='12%') Datum
            th(width='16%') Partner
            th(width='10%') Besitzer
                -var showfilter = false
                if(session.plainsearch.users)
                    -showfilter = true
                if(session.plainsearch.users === '.*')
                    -showfilter = false
                if(showfilter)
                    i.material-icons.tiny(alt=docdata.plainsearch.users) filter_list
            th(width='25%') Tags
            th(width='5%') Vorschau
            if(data)
                each item in data
                    tr
                        td.ppgrid
                            -var linktitle = '';
                            if(item.subject)
                                -linktitle = item.subject;
                            else
                                -linktitle = item._id;
                            a.overview(href="/doc/" + item._id + '/update/')= linktitle
                        td.ppgrind= item.previews
                        td.ppgrid
                            if(item.docdate)
                                span= moment(item.docdate, 'DD.MM.YYYY').format('DD.MM.YYYY')
                            else
                                ='-'
                        td.ppgrid
                            if(item.partner)
                                a(href='/doc/?partner=' + item.partner)= item.partner
                            else
                                ='-'
                        td.ppgrid
                            if(item.users)
                                if(typeof item.users !== 'string')
                                    each user in item.users.sort()
                                        a(href='/doc/?users=' + user)= user
                                        =' '
                                else
                                    a(href='/doc/?users=' + item.users)= item.users
                            else
                                ='-'
                        td.ppgrid
                            if(item.tags)
                                if(typeof item.tags !== 'string')
                                    each tag in item.tags.sort()
                                        a(href='/doc/?tags=' + tag)= tag
                                        =' '
                                else
                                    a(href='/doc/?tag=' + item.tags)= item.tags
                            else
                                ='-'
                        td.ppgrid
                            a.hoverover(id=item._id, style='cursor: zoom-in;')
                                i.material-icons.small attach_file

        div#hoverimage.popup(style='display:none;')= ' '
        script.
            $(document).ready(function(){
                $('.hoverover').on('mouseenter', function(evt){
                    let src = this;
                    let left = $(window).width() / 3.;
                    console.log(left);
                    console.log($(window).width());

                    $('#hoverimage')
                        .html('<img height="' + ($(window).height() * 0.85) + '" src="/doc/' + src.id + '/preview/" />')
                        .css({left: left, top: 100})
                        .show();
                        $(this).on('mouseleave', function(){
                            $('#hoverimage').hide();
                    });
                });
            });